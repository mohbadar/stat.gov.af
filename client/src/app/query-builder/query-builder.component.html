<div class="query-wrapper container-fluid" *ngIf="!isVisualize">
  <div class="action-bar">
    <div class="card bg-transparent no-shadow">
      <div class="card-body">
        <!-- <div class="dropdown inline-block">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">
            <button class="btn btn-social btn-fill btn-youtube shadowed">
              <i class="fa fa-pie-chart"></i> Spreadsheets
              <i class="fa fa-angle-down"></i>
            </button>
          </a>
          <ul class="dropdown-menu">
            <li><a>Home</a></li>
            <li><a>Home</a></li>
            <li><a>Home</a></li>
            <li><a>Home</a></li>
            <li><a>Home</a></li>
            <li><a>Home</a></li>
          </ul>
        </div>
        <div class="dropdown inline-block sheet-number ml-1">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">
            <button class="btn btn-social btn-fill btn-facebook">
              <i class="fa fa-pie-chart"></i> Sheet Number
              <i class="fa fa-angle-down"></i>
            </button>
          </a>
          <ul class="dropdown-menu">
            <li><a>Home</a></li>
            <li><a>Home</a></li>
            <li><a>Home</a></li>
            <li><a>Home</a></li>
            <li><a>Home</a></li>
            <li><a>Home</a></li>
          </ul>
        </div> -->
        <!-- <div> -->
        <div class="inline-block ml-1">
          <!-- <p class="text-secondary">Do you want to attach a file or select a dataset from data.gov.af?</p> -->
          <p class="text-secondary">Please select dataset from Data.gov.af</p>
        </div>
        <!-- <div class="inline-block ml-1">
            <label class="text-secondary"><input type="radio" name="sourceData" value="dataset"
                (change)="handleChange($event)"> Select a Dataset</label>
          </div>
          <div class="inline-block ml-1">
            <label class="text-secondary"><input type="radio" name="sourceData" value="file"
                (change)="handleChange($event)"> Attach a file</label>
          </div> -->
        <!-- </div> -->

        <div class="inline-block ml-1">
          <select2 [data]="selectOptions" [cssImport]=true [width]="300" (valueChanged)="changed($event)"
            id="selectDataset"></select2>
          <!-- <input type="file" (change)="onFileChange($event)" multiple="false" class="btn btn-secondary" id="inputFile">
          <button class="btn btn-primary btn-fill ml-1" id="btnAtach">Submit</button> -->
        </div>

      </div>
    </div>

  </div>
  <div class="row">
    <div class="col-md-2">
      <div class="card">
        <div class="header">
          <h5>{{ workBookName }}</h5>
          <hr>
        </div>
        <div class="content">
          <div class="sheetlist">
            <ul style="list-style: none;" *ngIf="data" style="padding: 0px;">
              <li *ngFor="let col of columnNames; let i=index" class="column-name"
                (click)="toggleColumn($event.target, i)">
                <input type="checkbox" class="c-box" [id]="col.name" checked>
                <span class="ml-1">{{col.name}}</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-10">
      <div class="card">
        <div class="header"></div>
        <div class="content">
          <div class="filter-show" *ngIf="columnDataType !== '' && columnDataType !== 'undefined'">
            <div class="inline-block">
              <h6>{{ selectedColumnName }}</h6>
            </div>
            <div class="dropdown inline-block ml-1">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <span class="btn btn-primary btn-fill">
                  {{ action }}
                  <i class="fa fa-angle-down"></i>
                </span>
              </a>
              <ul class="dropdown-menu numbers-dropdown" *ngIf="columnDataType === 'number'">
                <li (click)="setAction('flEq','Equal to', true)"><a>equal to (=)</a></li>
                <li (click)="setAction('flLt','Less then', false)"><a>less then (&lt;)</a></li>
                <li (click)="setAction('flGr','Greater then', false)"><a>greater then (&gt;)</a></li>
                <li (click)="setAction('flLtEq','Less or Equal', false)"><a>less then or equal to (&lt;=)</a></li>
                <li (click)="setAction('flGrEq','Greater or Equal', false)"><a>greater then or equal to (&gt;=)</a></li>
                <li (click)="setAction('flNEq','Not Equal', true)"><a>not equal to (!=)</a></li>
                <li (click)="setAction('flRng','In Range', true)"><a>In a range (Inclusive)</a></li>
                <li (click)="setAction('flNRng','Not in Range', true)"><a>Not in a range (Inclusive)</a></li>
              </ul>

              <ul class="dropdown-menu string-dropdown" *ngIf="columnDataType === 'string'">
                <li (click)="setAction('flCn','Contains', true)"><a>Contains</a></li>
                <li (click)="setAction('flCnS','Contains start', true)"><a>Contains in the start</a></li>
                <li (click)="setAction('flCnE','Contains end', true)"><a>Contains in the end</a></li>
                <li (click)="setAction('flNCn','Not Contains', true)"><a>Doesn't contain</a></li>
              </ul>
            </div>
            <div class="filter-count inline-block ml-1">
              <input type="checkbox" name="multiple" [disabled]="!applyMultiple" id="multiple-filter"> Multiple<i
                class="fa fa-info-circle" data-toggle="tooltip" data-placement="top"
                title="Add more then one inputs seperated by commas"></i>
            </div>
            <div class="first-input inline-block ml-1">
              <input type="text" class="form-control" placeholder="filter string"
                (keyup)="setFilteValue($event.target.value)">
            </div>
            <div class="apply-filter inline-block ml-1">
              <button class="btn btn-primary btn-fill" [disabled]="!filterAction" (click)="testData()">Apply</button>
            </div>
          </div>
          <div class="undefined-data-type text-center" *ngIf="columnDataType === 'undefined'">
            <h3>Please choose a data type for this column</h3>
            <div class="data-types-options">
              <button class="btn btn-info btn-sm btn-fill " (click)="updateDataType('number')">Number</button>
              <button class="btn btn-warning btn-sm btn-fill ml-1" (click)="updateDataType('string')">String</button>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="header"></div>
        <div class="content">
          <div class="table-show">
            <span class="table-label">Table</span>
            <a class="btn btn-sm visualize ml-1" (click)="generateChart()" data-toggle="modal"
              data-target="#newVisualization">+ New Visualization</a>
              
            <div class="inline-block ml-1 pull-right" *ngIf="authService.isLoggedIn()">
              <button class="btn btn-success btn-fill btn-sm " (click)="saveChanges()" *ngIf="data.length">Save
                Chnages</button>
            </div>

            <div class="inline-block ml-1 pull-right ">
              <button class="btn btn-secondary btn-fill btn-sm " (click)="resetData()"
                *ngIf="data.length">Reset</button>
            </div>
            <!-- <span class="btn btn-xs btn-info btn-fill pull-right" (click)="resetData()">reset</span>
            <span class="btn btn-xs btn-info btn-fill pull-right" (click)="generateChart()">generate chart</span> -->
            <div class="toolbar">
              <!--        Here you can write extra buttons/actions for the toolbar              -->
            </div>
            <div class="fresh-datatables" *ngIf="data.length"><br>
              <table id="datatables" class="table table-striped table-no-bordered table-hover" cellspacing="0"
                width="100%" style="width:100%">
                <thead>
                  <tr>
                    <th *ngFor="let val of columnNames; let i=index" class="p-1">
                      <span (click)="showFilters(columnDataTypes[i], i)">
                        {{val.name}}
                      </span>
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let row of data">
                    <td *ngFor="let val of row.rowData; let j=index" class="p-1">
                      {{val}}
                    </td>
                  </tr>
                </tbody>
                <tfoot>
                  <tr>
                    <th *ngFor="let val of columnNames; let i=index" class="p-1">
                      {{val.name}}
                      <!-- <input type="text" class="table-search" [placeholder]="val.name"> -->
                    </th>
                  </tr>
                </tfoot>
              </table><br>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<div class="query-wrapper container-fluid" *ngIf="isVisualize">
  <visualize [columns]="visualizationColumns" [rows]="visualizationRows" (closeFlag)="hideVisualization()"></visualize>
</div>